<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Oncology Quiz | ADMIN</title>
    <style>
        body { font-family: 'Poppins', sans-serif; background: #1a1a1a; color: white; text-align: center; }
        .panel { background: #2a2a2a; margin: 20px auto; padding: 20px; width: 80%; border-radius: 15px; }
        button { padding: 10px 20px; margin: 10px; cursor: pointer; border-radius: 5px; border: none; font-weight: bold; }
        .reset-btn { background: #ef4444; color: white; }
        .start-btn { background: #10b981; color: white; }
        .results-btn { background: #3b82f6; color: white; }
        .team-box { display: inline-block; width: 45%; border: 1px solid #444; padding: 10px; margin: 5px; }
    </style>
</head>
<body>
    <h1>Panneau de Contrôle Admin</h1>
    
    <div class="panel">
        <button class="reset-btn" onclick="resetComp()">1. RESET (Initialisation)</button>
        <button class="start-btn" onclick="startQuiz()">2. START (Lancer le Quiz)</button>
        <button class="results-btn" onclick="showResults()">3. SHOW RESULTS (Afficher)</button>
    </div>

    <div class="panel">
        <div class="team-box" id="pink-status">
            <h3>Team Rose</h3>
            <p>Nom: <span id="p-name">---</span></p>
            <p>Score: <span id="p-score">0</span></p>
        </div>
        <div class="team-box" id="purple-status">
            <h3>Team Violette</h3>
            <p>Nom: <span id="v-name">---</span></p>
            <p>Score: <span id="v-score">0</span></p>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script>
        const firebaseConfig = { databaseURL: "https://quiz-8016b-default-rtdb.firebaseio.com/" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database().ref('competition');

        function resetComp() {
            if(confirm("Réinitialiser tout ?")) {
                db.set({
                    status: 'waiting',
                    teamPink: "", userPink: "", scorePink: 0, finishedPink: false,
                    teamPurple: "", userPurple: "", scorePurple: 0, finishedPurple: false,
                    startTime: 0, showResults: false
                });
            }
        }

        function startQuiz() {
            db.update({ status: 'start', startTime: Date.now() });
        }

        function showResults() {
            db.update({ showResults: true });
        }

        db.on('value', snap => {
            const d = snap.val(); if(!d) return;
            document.getElementById('p-name').innerText = d.teamPink || "---";
            document.getElementById('p-score').innerText = d.scorePink || 0;
            document.getElementById('v-name').innerText = d.teamPurple || "---";
            document.getElementById('v-score').innerText = d.scorePurple || 0;
        });
    </script>
</body>
</html>
